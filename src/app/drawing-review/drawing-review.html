<div class = "banner">
    
     <div class = "bannertext"> {{UserName.UserFirst}}'s Drawing Board 
      
     </div>
     <img src="assets/ToolingLogo.png" class="banner-profile">
     
</div>
<div class = "Screen">
    
    <div class ="Sidebar">
        SideBar
        <!--<div class = "BacklogDesign"> <button matTooltip = "Backlog Project List" mat-icon-button (click) = "toBacklogDesign()" ><mat-icon class = "backlogDesignicon" >featured_play_list</mat-icon></button></div>
        <div class = "BacklogDesign"> <button matTooltip = "Backlog Project List" mat-icon-button (click) = "ToolNumberGenRoute()" ><mat-icon class = "backlogDesignicon" >numbers</mat-icon></button>
        Tool Number</div>
        
        <div class = "BacklogDesign"> <button matTooltip = "Remove From My Project List" mat-icon-button  ><mat-icon class = "backlogDesignicon" >history_edu</mat-icon></button>
        Tool History</div>
        <div class = "BacklogDesign"> <button matTooltip = "Remove From My Project List" mat-icon-button  ><mat-icon class = "backlogDesignicon" >build</mat-icon></button>
        Tool Repair Report</div>
        <div class = "BacklogDesign"> <button matTooltip = "Remove From My Project List" mat-icon-button  ><mat-icon class = "backlogDesignicon" >draw</mat-icon></button>
        Drawing Review</div>-->
    </div>
<div class ="Project-Container">
    <!-- Overview -->
    <div class="card-container">
        <mat-card class="example-card" appearance="outlined">
                <mat-card-header class = "HeaderOverall">

                    <mat-card-title class ="OverviewTitle">
                        <div>Drawing Review Overview</div>
                       

                    </mat-card-title>
                    <mat-card-subtitle></mat-card-subtitle>
                    
                     <div><button class = "CompleteButton"  (click) = "openNewDrawRev(NewReview,0,0)" mat-flat-button style="background-color: #259203; color: white;" >New Review</button></div>
                </mat-card-header>
                <mat-card-content class="content">
                    <div class = "headeritem">
                        <mat-card class = "cardHead">
                            <mat-card-header class = "Header">
                               <mat-card-title>Outbound Open Review Requests</mat-card-title>
                            </mat-card-header>
                            
                            <div class  = "Prevnumber">{{countOut}}</div>
                        </mat-card>
                        
                    </div>
                    <div class = "headeritem">
                        <mat-card class = "cardHead">
                            <mat-card-header class = "Header">
                               <mat-card-title> Inbound Open Review Requests</mat-card-title>
                            </mat-card-header>
                            <div class  = "Prevnumber">{{countIn}}</div>
                        </mat-card>
                    </div>
                </mat-card-content>
        </mat-card>
    </div>

    <!-- Drawing Review Function and list-->
    <div class="card-container">
     <mat-expansion-panel [expanded]="true" > <!--Expansion panel for Outbound-->
        <mat-expansion-panel-header>
            <mat-panel-title>
                Designer Items
            </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-card-content class="contentdrw">
            <ng-container *ngFor = "let Invdr of DR">
                <ng-container *ngIf = "Invdr.FromUID === uid && Invdr.FirstItem === 1 && Invdr.Complete === 0">
                    <mat-expansion-panel [expanded]="true" > <!--Looped all drawing Reviews-->
                    <mat-expansion-panel-header>
                        <mat-panel-title>

                            <div>{{Invdr.ToolNumber}} - {{Invdr.ToolDesc}}</div>
                            <ng-container *ngIf = "Warnlogic(Invdr.DateSub, Invdr.DateNeed) ">  <!--Within a day Warning-->
                                <div><mat-icon class = "WarnIcon" matTooltip = "Action Needed Still" matTooltipPosition = "below" >warning_amber</mat-icon></div>
                            </ng-container>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <mat-card-content class="contentdrw">
                       <!--Drawing Review Information Display-->
                       <ng-container *ngFor = "let Revdr of DR; let i = index">
                        <ng-container *ngIf = "Revdr.FromUID === uid && (Invdr.DID === Revdr.Revs || (Revdr.FirstItem === 1 && Revdr.DID === Invdr.DID) )">
                       <mat-expansion-panel [expanded]="false" > <!--Drafts looping-->
                            <mat-expansion-panel-header>
                        
                            <mat-panel-title>
                            <div><mat-icon *ngIf = " Revdr.RedFileName !== null" matTooltip = "Redlines Recivied" matTooltipPosition = "below" >check_circle</mat-icon></div>
                            <div>{{Revdr.ToolNumber}} - {{Revdr.ToolDesc}}</div>
                            <ng-container *ngIf = "Warnlogic(Invdr.DateSub, Invdr.DateNeed)">  <!--Within a day Warning-->
                                <div><mat-icon class = "WarnIcon" matTooltip = "Action Needed Still" matTooltipPosition = "below" >warning_amber</mat-icon></div>
                            </ng-container>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                        <mat-card class = "cardHead">
                            <mat-card-header class = "Header">
                               <mat-card-title>Review Revsion Info</mat-card-title>
                            </mat-card-header>
                            
                            <div class = "table">
                                <div class = "Column">
                                    <div>Tool Name</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.ToolDesc}}</div>
                                </div>
                                <mat-divider [vertical]="true"></mat-divider>
                                <div class = "Column">
                                    <div>Sender</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.FromName}}</div>
                                </div>
                                <mat-divider [vertical]="true"></mat-divider>
                                 <div class = "Column">
                                    <div>Reviewer</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.ToName}}</div>
                                </div>
                                <mat-divider [vertical]="true"></mat-divider>
                                 <div class = "Column">
                                    <div>Date Sent</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.DateSub}}</div>
                                </div>
                                <mat-divider [vertical]="true"></mat-divider>
                                 <div class = "Column">
                                    <div>Need by Date</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.DateNeed}}</div>
                                </div>
                            </div>
                        </mat-card>
                        <mat-expansion-panel [expanded]="true" >
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    File Information
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <!-- File Upload Area -->
                        <div class = "downloadUpload">
                           
                                <div class = "download"> 
                                    <div class = "downheader"> Document to be Reviewed </div>
                                    <div class = "Downtext">{{Revdr.FileName}}</div>
                                    <div class = "DownBut" ><button class = "CompleteButton"  (click) = "FileDownload(Revdr.FileName!)" mat-flat-button style="background-color: #259203; color: white;" >Download</button></div>
                                </div>
                           
                                <mat-divider vertical class="divider"></mat-divider>
                                
                                <div class = "download"> 
                                    <ng-container *ngIf = "Revdr.RedFileName !== null; else noFile">
                                    <div class = "downheader"> Redlines </div>
                                    <div class = "Downtext">{{Revdr.RedFileName}}</div>
                                    <div class = "DownBut" ><button class = "CompleteButton"  (click) = "FileDownload(Revdr.RedFileName!)" mat-flat-button style="background-color: #259203; color: white;" >Download</button></div>
                                    </ng-container>
                                </div>
                                
                       
                        </div>
                        </mat-expansion-panel>
                        
                    </mat-expansion-panel>
                    </ng-container>
                        </ng-container>
                    </mat-card-content>
                    <div class = "InvRevBut">
                        <div class = "CompleteBut" ><button class = "CompleteButton"  (click) = "openNewDrawRev(NewReview,Invdr.DID!,Invdr.ToUID!)" mat-flat-button style="background-color: #259203; color: white;" >New Draft</button></div>
                         <div class = "CompleteBut"><button class = "CompleteButton"  (click) = CompleteDrwRev(Invdr.DID!) mat-flat-button style="background-color: #918700; color: white;" >Complete Review</button></div>
                    </div>
                        </mat-expansion-panel>
        </ng-container>
    </ng-container>
        </mat-card-content>
    </mat-expansion-panel>
    </div>
    

    <!-- InBound Reviews -->
     <div class="card-container">
     <mat-expansion-panel [expanded]="true" > <!--Expansion panel for Outbound-->
        <mat-expansion-panel-header>
            <mat-panel-title>
                Reviewer Items
            </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-card-content class="contentdrw">
            <ng-container *ngFor = "let Invdr of DR">
                <ng-container *ngIf = "Invdr.ToUID === uid && Invdr.FirstItem === 1 && Invdr.Complete === 0">
                    <mat-expansion-panel [expanded]="true" > <!--Looped all drawing Reviews-->
                    <mat-expansion-panel-header>
                        <mat-panel-title>

                            <div>{{Invdr.ToolNumber}} - {{Invdr.ToolDesc}}</div>
                            <ng-container *ngIf = "Warnlogic(Invdr.DateSub, Invdr.DateNeed) ">  <!--Within a day Warning-->
                                <div><mat-icon class = "WarnIcon" matTooltip = "Action Needed Still" matTooltipPosition = "below" >warning_amber</mat-icon></div>
                            </ng-container>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <mat-card-content class="contentdrw">
                       <!--Drawing Review Information Display-->
                       <ng-container *ngFor = "let Revdr of DR; let i = index">
                        <ng-container *ngIf = "Revdr.ToUID === uid && (Invdr.DID === Revdr.Revs || (Revdr.FirstItem === 1 && Revdr.DID === Invdr.DID) )">
                       <mat-expansion-panel [expanded]="false" > <!--Drafts looping-->
                            <mat-expansion-panel-header>
                        
                            <mat-panel-title>

                            <div>{{Revdr.ToolNumber}} - {{Revdr.ToolDesc}}</div>
                            <ng-container *ngIf = "Warnlogic(Invdr.DateSub, Invdr.DateNeed)">  <!--Within a day Warning-->
                                <div><mat-icon class = "WarnIcon" matTooltip = "Action Needed Still" matTooltipPosition = "below" >warning_amber</mat-icon></div>
                            </ng-container>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                        <mat-card class = "cardHead">
                            <mat-card-header class = "Header">
                               <mat-card-title>Review Revsion Info</mat-card-title>
                            </mat-card-header>
                            
                            <div class = "table">
                                <div class = "Column">
                                    <div>Tool Name</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.ToolDesc}}</div>
                                </div>
                                <mat-divider [vertical]="true"></mat-divider>
                                <div class = "Column">
                                    <div>Designer</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.FromName}}</div>
                                </div>
                                <mat-divider [vertical]="true"></mat-divider>
                                 <div class = "Column">
                                    <div>Reviewer</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.ToName}}</div>
                                </div>
                                <mat-divider [vertical]="true"></mat-divider>
                                 <div class = "Column">
                                    <div>Date Sent</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.DateSub}}</div>
                                </div>
                                <mat-divider [vertical]="true"></mat-divider>
                                 <div class = "Column">
                                    <div>Need by Date</div>
                                    <mat-divider ></mat-divider>
                                    <div>{{Revdr.DateNeed}}</div>
                                </div>
                            </div>
                        </mat-card>
                        <mat-expansion-panel [expanded]="true" >
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    File Information
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <!-- File Upload Area -->
                        <div class = "downloadUpload">
                           
                                <div class = "download"> 
                                    <div class = "downheader"> Document to be Reviewed </div>
                                    <div class = "Downtext">{{Revdr.FileName}}</div>
                                    <div class = "DownBut" ><button class = "CompleteButton"  (click) = "FileDownload(Revdr.FileName!)" mat-flat-button style="background-color: #259203; color: white;" >Download</button></div>
                                </div>
                           
                                <mat-divider vertical class="divider"></mat-divider>
                                
                                <div class = "download"> 
                                    <ng-container *ngIf = "Revdr.RedFileName !== null; else noFileReviwer">
                                    <div class = "downheader"> Redlines </div>
                                    <div class = "Downtext">{{Revdr.RedFileName}}</div>
                                    <div class = "DownBut" ><button class = "CompleteButton"  (click) = "FileDownload(Revdr.RedFileName!)" mat-flat-button style="background-color: #259203; color: white;" >Download</button></div>
                                    </ng-container>

                                    <ng-template #noFileReviwer>
                                    <mat-card-content class="contentdrw">
                                            Upload Redline Drawing Below
                                            <div>
                                            <input type="file" class="file-input"  (change)="onChange($event)" #fileUpload />

                                            <div *ngIf="file">
                                                <section class="file-info">
                                                    <ul>
                                                    <li>Name: {{file.name}}</li>
                                                    <li>Type: {{file.type}}</li>
                                                    <li>Size: {{file.size}} bytes</li>
                                                    </ul>
                                                </section>
                                            </div>
                                            </div>
                                    </mat-card-content>
                                    <mat-dialog-actions align="end">
                                    <button mat-flat-button color="primary" (click) = "RedlineUpload(Revdr.DID!)"mat-dialog-close [disabled] = "file === null" >Upload</button>
                                </mat-dialog-actions>
                                </ng-template>
                                </div>
                                
                       
                        </div>
                        </mat-expansion-panel>
                        
                    </mat-expansion-panel>
                    </ng-container>
                        </ng-container>
                    </mat-card-content>
                    <div class = "InvRevBut">
                        <!-- <div class = "CompleteBut" ><button class = "CompleteButton"  (click) = "openNewDrawRev(NewReview,Invdr.DID!)" mat-flat-button style="background-color: #259203; color: white;" >New Draft</button></div> -->
                         <!-- <div class = "CompleteBut"><button class = "CompleteButton"  (click) = CompleteDrwRev(Invdr.DID!) mat-flat-button style="background-color: #918700; color: white;" >Complete Review</button></div> -->
                    </div>
                        </mat-expansion-panel>
        </ng-container>
    </ng-container>
        </mat-card-content>
    </mat-expansion-panel>
    </div>

</div>

<ng-template #NewReview>
    <div>
        <div class = "reviewtitle"> Request Drawing Review</div>
        <div class = "row">
            <div class = "dropdown">
                <div> Designer: </div>
                <mat-form-field >
                    <mat-select [(ngModel)]="new_DR.FromUID" placeholder="DesignerUser" [disabled]="new_DR.FromUID !== null">
                        <mat-option *ngFor ="let user of Names" [value] = "user.UID">
                            {{ user.UserFirst }} {{ user.UserLast }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class = "dropdown">
                <div> Reviwer: </div>
                <mat-form-field >
                    <mat-select [(ngModel)]="new_DR.ToUID" placeholder="Reviewer" [disabled]="new_DR.ToUID !== null">
                        <mat-option *ngFor ="let user of Names" [value] = "user.UID">
                            {{ user.UserFirst }} {{ user.UserLast }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class = "dropdown">
                <div> Need by Date </div>
                <mat-form-field>
                    <mat-label>Choose a date</mat-label>
                    <input matInput [matDatepicker]="picker" [(ngModel)] = "new_DR.DateNeed">
                    <mat-hint>MM/DD/YYYY</mat-hint>
                    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
            </div>
        </div>
        <div class = "row">
            <div class = "textlabelsnum">
            Tool Number
            <mat-form-field class="ToolNumber">
                <mat-label></mat-label>
                <input matInput
                [(ngModel)] = "new_DR.ToolNumber"
                placeholder="ToolNumber"
                value= "new_DR.ToolNumber"
                >
            </mat-form-field>
        </div>
        <div class = "textlabelsdesc">
            Tool Description
            <mat-form-field class="ToolDesc">
                <mat-label></mat-label>
                <input matInput
                [(ngModel)] = "new_DR.ToolDesc"
                placeholder="Tool Name"
                value= "new_DR.ToolDesc"
                >
            </mat-form-field>
        </div>
        </div>
        <!-- File Upload Area -->
        <mat-card-content class="contentdrw">
            Upload Drawing Draft Below
            <div>
            <input type="file" class="file-input"  (change)="onChange($event)" #fileUpload />

            <div *ngIf="file">
                <section class="file-info">
                    <ul>
                    <li>Name: {{file.name}}</li>
                    <li>Type: {{file.type}}</li>
                    <li>Size: {{file.size}} bytes</li>
                    </ul>
                </section>
            </div>
            </div>
    </mat-card-content>
    </div>
    <mat-dialog-actions align="end">
    <button mat-button mat-dialog-close (click) = ToUID()>Cancel</button>
    <button mat-flat-button color="primary" (click) = "NewDrawRev_Logic()"mat-dialog-close [disabled] = "new_DR.ToolNumber === null || new_DR.ToolDesc === null || new_DR.DateNeed === null || new_DR.FromUID === null || new_DR.ToUID === null || file === null" >Verify</button>
  </mat-dialog-actions>
  
    
</ng-template>

<ng-template #noFile>
    <div class="Downtext">Review in process </div>
  </ng-template>


